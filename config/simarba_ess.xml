<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
           http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"
	default-init-method="init" default-destroy-method="destroy">
	<bean id="simulation" class="il.ac.tau.yoavram.pes.Simulation">
		<property name="terminators">
			<list>
				<bean id="tickTerminator" class="il.ac.tau.yoavram.pes.terminators.TickTerminator">
					<property name="endAtTick" value="${numberOfTicks}" />
				</bean>
			</list>
		</property>
		<property name="model" ref="simarbaModel" />
		<property name="dataGatherers">
			<list>
				<ref bean="bacteriaDataGatherer" />
			</list>
		</property>
		<property name="blockAtEnd" value="${simulation.block}" />
		<property name="ID" value="${jobName}.${time}" />
	</bean>
	<bean id="environment" class="il.ac.tau.yoavram.simarba.Environment">
		<property name="numberOfEnvironmentalGenes" value="${numberOfEnvironmentalGenes}" />
		<property name="numberOfHousekeepingGenes" value="${numberOfHousekeepingGenes}" />
		<property name="numberOfModifierGenes" value="${numberOfModifierGenes}" />
		<property name="selectionDistribution">
			<bean
				class="il.ac.tau.yoavram.pes.random.NormalDistributionSupportedOnTheUnit">
				<property name="mean" value="${meanSelectionCoefficient}" />
				<property name="standardDeviation" value="${stdSelectionCoefficient}" />
			</bean>
		</property>
	</bean>
	<bean id="ancestor" class="il.ac.tau.yoavram.simarba.RandomAncestor">
		<property name="mutationRate" value="${mutationRate}" />
		<property name="transformationRate" value="${transformationRate}" />
		<property name="mutationThreshold" value="${mutationThreshold}" />
		<property name="transformationThreshold" value="${transformationThreshold}" />
		<property name="alleleChangeDistribution">
			<bean class="il.ac.tau.yoavram.pes.random.NormalDistribution">
				<property name="mean" value="${meanAlleleChange}" />
				<property name="standardDeviation" value="${stdAlleleChange}" />
			</bean>
		</property>
		<property name="mutationRateChangeDistribution">
			<bean class="il.ac.tau.yoavram.pes.random.NormalDistribution">
				<property name="mean" value="${meanMutationRateChange}" />
				<property name="standardDeviation" value="${stdMutationRateChange}" />
			</bean>
		</property>
		<property name="thresholdChangeDistribution">
			<bean class="il.ac.tau.yoavram.pes.random.NormalDistribution">
				<property name="mean" value="${meanThresholdChange}" />
				<property name="standardDeviation" value="${stdThresholdChange}" />
			</bean>
		</property>
		<property name="transformationRateChangeDistribution">
			<bean class="il.ac.tau.yoavram.pes.random.NormalDistribution">
				<property name="mean" value="${meanTransformationRateChange}" />
				<property name="standardDeviation" value="${stdTransformationRateChange}" />
			</bean>
		</property>
	</bean>
	<bean id="simarbaModel" class="il.ac.tau.yoavram.simarba.SimarbaModel">
		<property name="populationSize" value="${populationSize}" />
		<property name="environment" ref="environment" />
		<property name="ancestor" ref="ancestor" />
		<property name="serializedAtEnd" value="true" />
		<property name="dir" value="${serialization.dir}/" />
		<property name="ID" value="${jobName}.${time}" />
		<property name="genomicMemory">
			<bean class="il.ac.tau.yoavram.simarba.GenomicMemory">
				<property name="capacity" value="${genomicMemoryCapacity}" />
			</bean>
		</property>
		<property name="changeEnvironmentOnStartup" value="${changeEnvironmentOnStartup}" />
		<property name="fractionOfGenesToChange" value="${fractionOfGenesToChange}" />
		<property name="environmentalChangeFrequency" value="${environmentalChangeFrequency}" />
	</bean>

	<bean id="bacteriaDataGatherer" class="il.ac.tau.yoavram.simba.statistics.SimbaDataGatherer">
		<property name="model" ref="simarbaModel" />
		<property name="interval" value="${statistics.interval}" />
		<property name="filters">
			<list>
			</list>
		</property>
		<property name="listeners">
			<list>
				<bean class="il.ac.tau.yoavram.pes.statistics.listeners.CsvWriterListener">
					<property name="csvWriter">
						<bean class="il.ac.tau.yoavram.pes.io.csv.CsvWriter">
							<property name="filename" value="${jobName}.${time}" />
							<property name="directory" value="${output.dir}/${jobName}" />
							<property name="writeTempFile" value="true" />

						</bean>
					</property>
				</bean>
				<bean class="il.ac.tau.yoavram.pes.statistics.listeners.ChartDrawer">
					<property name="title" value="${jobName}.${time}" />
					<property name="showApplet" value="${simulation.block}" />
					<property name="filename"
						value="${output.dir}/${jobName}/${jobName}.${time}" />

				</bean>
			</list>
		</property>
		<property name="aggregators">
			<list>
				<bean class="il.ac.tau.yoavram.pes.statistics.aggregators.Ticker">
					<property name="name" value="tick" />
				</bean>
				<ref bean="meanFitness" />
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.MinimumFitness">
					<property name="name" value="min fitness" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.MaximumFitness">
					<property name="name" value="max fitness" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.StandardDeviationFitness">
					<property name="name" value="stdev fitness" />
					<property name="meanAggregator" ref="meanFitness" />
				</bean>
				<ref bean="meanMutationRate" />
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.MinimumMutationRate">
					<property name="name" value="min mutation rate" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.MaximumMutationRate">
					<property name="name" value="max mutation rate" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simba.statistics.aggregators.StandardDeviationMutationRate">
					<property name="name" value="stdev mutation rate" />
					<property name="meanAggregator" ref="meanMutationRate" />
				</bean>
				<ref bean="meanTransformationRate" />
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MinimumTransformationRate">
					<property name="name" value="min transformation rate" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MaximumTransformationRate">
					<property name="name" value="max transformation rate" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.StandardDeviationTransformationRate">
					<property name="name" value="stdev transformation rate" />
					<property name="meanAggregator" ref="meanTransformationRate" />
				</bean>
				<ref bean="meanMutationThreshold" />
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MinimumMutationThreshold">
					<property name="name" value="min mutation threshold" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MaximumMutationThreshold">
					<property name="name" value="max mutation threshold" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.StandardDeviationMutationThreshold">
					<property name="name" value="stdev mutation threshold" />
					<property name="meanAggregator" ref="meanMutationThreshold" />
				</bean>
				<ref bean="meanTransformationThreshold" />
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MinimumTransformationThreshold">
					<property name="name" value="min transformation threshold" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.MaximumTransformationThreshold">
					<property name="name" value="max transformation threshold" />
				</bean>
				<bean
					class="il.ac.tau.yoavram.simarba.statistics.aggregators.StandardDeviationTransformationThreshold">
					<property name="name" value="stdev transformation threshold" />
					<property name="meanAggregator" ref="meanTransformationThreshold" />
				</bean>
			</list>
		</property>
	</bean>
	<bean id="meanFitness"
		class="il.ac.tau.yoavram.simba.statistics.aggregators.MeanFitness">
		<property name="name" value="mean fitness" />
	</bean>
	<bean id="meanMutationRate"
		class="il.ac.tau.yoavram.simba.statistics.aggregators.MeanMutationRate">
		<property name="name" value="mean mutation rate" />
	</bean>
	<bean id="meanTransformationRate"
		class="il.ac.tau.yoavram.simarba.statistics.aggregators.MeanTransformationRate">
		<property name="name" value="mean transformation rate" />
	</bean>
	<bean id="meanMutationThreshold"
		class="il.ac.tau.yoavram.simarba.statistics.aggregators.MeanMutationThreshold">
		<property name="name" value="mean mutation threshold" />
	</bean>
	<bean id="meanTransformationThreshold"
		class="il.ac.tau.yoavram.simarba.statistics.aggregators.MeanTransformationThreshold">
		<property name="name" value="mean transformation threshold" />
	</bean>
</beans>